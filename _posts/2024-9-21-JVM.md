---
typora-root-url: ./..
typora-copy-images-to: ./..\assets\img\2024-9-21-JVM
---

## JVM基础篇

### 初识JVM

Java Virtual Machine

1、运行java字节码文件，解释成字节码让计算机执行，.class由字节码指令构成

2、内存管理，自动为对象方法等分配功能，自动垃圾回收

3、即时编译(Just-In-Time，JIT)，对热点代码进行优化,提升执行效率

java需要实时解释主要为了跨平台特性

### 字节码文件详解

#### JVM组成

![jvm-construction](/assets/img/2024-9-21-JVM/jvm-construction.png)

#### 字节码文件组成

1. 基础信息：魔数、字节码文件对应的Java版本号、访问标识、父类和接口

2. 常量池：字符串常量、类或接口名、字段名
3. 字段：当前类或接口声明的字段信息
4. 方法：方法的字节码指令
5. 属性：类的属性

字节码指令中通过编号引用到常量池的过程称为符号引用

![jvm-class-method](/assets/img/2024-9-21-JVM/jvm-class-method.png)

`int i=0;i=i++;`i的值是什么

![jvm-demo1](/assets/img/2024-9-21-JVM/jvm-demo1.png)

通过分析字节码指令，i++先把0取出来放进操作数栈中，再+1，再将操作数栈中0放入i

分析字节码可知i++和k+=1操作性能一样

```
int i=0,j=0,k=0;
i++;
j=j+1;
k+=1;
```

工具：

命令行：javap -v，JDK自带反编译工具、arthas(dump、jad)、jclasslib

#### 类的生命周期

1. 加载：以二进制字节流获取字节码信息，类加载器加载完类后JVM将字节码中的信息保存到方法区中，生成一个InstanceKlass对象，保存类的所有信息，堆中生成一个java.lang.Class对象，静态字段数据存放在堆区Class对象中，控制开发者访问数据的范围
2. 连接：验证（验证内容是否满足虚拟机规范），准备（给静态变量赋初始值（默认值），final修饰的基本数据类型基本变量会赋代码中的值），解析（将常量池中的符号引用替换成指向内存的直接引用）
3. 初始化：
4. 使用
5. 卸载

### Java内存结构

### 垃圾回收

### 类的生命周期和类加载器

## 实战篇

### 内存泄漏

### GC调优

### 性能调优

## 高级篇

### 即时编译器JIT

### ASM字节码增强

### Java Agent技术

### ZGC

### GraalVM

## 原理篇

### Java对象布局

### 异常、反射原理

### G1垃圾回收器工作原理

### 编译器优化

## 面试篇

### 常见的JVM参数

### Tomcat的类加载器

### ThreadLocal会内存泄漏吗

### 如何优化减少Full GC

### 三色标记法是什么