---
title: Spring面试知识点
date: 2024-09-16 09:41:37 +0800
categories: [interview, Spring]
tags: [spring, note, interview]     # TAG names should always be lowercase
typora-root-url: ./..
---

## Spring基础

### 什么是Spring框架

一款开源的轻量级Java开发框架，提高开发效率和系统的可维护性

支持IoC(Inverse of Control控制反转)和AOP(Aspect-Oriented Programing面向切面编程)、对数据库访问很方便，方便集成第三方组件（电子邮件，任务，调度，缓存），对单元测试友好，支持RESTful Java应用程序

![在这里插入图片描述](/assets/img/2024-9-16-spring/spring-framework.png)

**Data Access/Integration spring-jdbc ：**

spring-jdbc提供了对数据库访问的抽象 JDBC。不同的数据库都有⾃⼰独⽴的 API ⽤于操作 数据库，⽽ Java 程序只需要和 JDBC API 交互，这样就屏蔽了数据库的影响。 spring-tx ：提供对事务的⽀持。 

spring-orm ： 提供对 Hibernate、JPA 、iBatis 等 ORM 框架的⽀持。 

spring-oxm ：提供⼀个抽象层⽀撑 OXM(Object-to-XML-Mapping)，例如：JAXB、Castor、 XMLBeans、JiBX 和 XStream 等。 

spring-jms : 消息服务。⾃ Spring Framework 4.1 以后，它还提供了对 spring-messaging 模块 的继承。

**Spring Web** 

spring-web ：对 Web 功能的实现提供⼀些最基础的⽀持。 

spring-webmvc ： 提供对 Spring MVC 的实现。 spring-websocket ： 提供了对 WebSocket 的⽀持，WebSocket 可以让客户端和服务端进⾏ 双向通信。 spring-webflux ：提供对 WebFlux 的⽀持。WebFlux 是 Spring Framework 5.0 中引⼊的新的 响应式框架。与 Spring MVC 不同，它不需要 Servlet API，是完全异步。

**AOP** 

spring-aspects ：该模块为与 AspectJ 的集成提供⽀持。 

spring-aop ：提供了⾯向切⾯的编程实现。 spring-instrument ：提供了为 JVM 添加代理（agent）的功能。 具体来讲，它为 Tomcat 提供 了⼀个织⼊代理，能够为 Tomcat 传递类⽂ 件，就像这些⽂件是被类加载器加载的⼀样。没有 理解也没关系，这个模块的使⽤场景⾮常有限。

**Core Container Spring** 框架的核⼼模块，也可以说是基础模块，主要提供 IoC 依赖注⼊功能的⽀持。Spring 其他所 有的功能基本都需要依赖于该模块，我们从上⾯那张 Spring 各个模块的依赖关系图就可以看出来。

 spring-core ：Spring 框架基本的核⼼⼯具类。 

spring-beans ：提供对 bean 的创建、配置和管理等功能的⽀持。 

spring-context ：提供对国际化、事件传播、资源加载等功能的⽀持。

 spring-expression ：提供对表达式语⾔（Spring Expression Language） SpEL 的⽀持，只依 赖于 core 模块，不依赖于其他模块，可以单独使⽤

**Messaging** 

spring-messaging 是从 Spring4.0 开始新加⼊的⼀个模块，主要职责是为 Spring 框架集成⼀些基 础的报⽂传送应⽤。

**Spring Test** Spring 团队提倡测试驱动开发（TDD）。有了控制反转 (IoC)的帮助，单元测试和集成测试变得更简 单。 Spring 的测试模块对 JUnit（单元测试框架）、TestNG（类似 JUnit）、Mockito（主要⽤来 Mock 对象）、PowerMock（解决 Mockito 的问题⽐如⽆法模拟 final, static， private ⽅法）等等常⽤的测 试框架⽀持的都⽐较好。

### Spring，Spring MVC，Spring Boot之间有什么关系

Spring包含了多个功能模块，最重要的是Spring-Core（主要提供IoC），Spring中其他模块如Spring MVC功能实现基本都要依赖于该模块

MVC架构是模型Model，视图View，控制器Controller分离来组织代码

Spring Boot旨在简化Spring开发，减少配置文件，避免开启某些Spring特性时XML或Java显式配置

## IOC

### 对Spring IoC的了解

IoC（Inverse of Control：控制反转）是一种设计思想，将原本在程序中手动创建对象的控制权，交由Spring框架来管理，在其他语言中也有应用

**控制**：指的是对象创建（实例化、管理）的权力

**反转**：控制权交给外部环境（Spring 框架、IoC 容器）

![IoC 图解](/assets/img/2024-9-16-spring/ioc.png)

将对象之间的相互依赖关系交给IoC容器管理，并由IoC容器完成对象的注入，把应用从复杂的依赖关系中解放，当创建一个对象时只需配置好不需要考虑对象如何创建出来的如构造函数

IoC容器是用来实现IoC的载体，实际上是个Map，存放各种对象

### 什么是Spring Bean

Bean指代被IoC容器管理的对象

### 将一个类声明为Bean注解有哪些
`@Component`：通用注解，可标注任意类为 `Spring` 组件。一个 Bean 不知道属于哪个层，可以使用`@Component` 注解标注。

`@Repository` : 对应持久层即 Dao 层

`@Service` : 对应服务层，主要涉及一些复杂的逻辑，需要用到 Dao 层。

`@Controller` : 对应 Spring MVC 控制层，主要用于接受用户请求并调用 `Service` 层返回数据给前端页面

### `@Component`和`@Bean`的区别

@Component 注解作⽤于类，⽽ @Bean 注解作⽤于⽅法。

@Component 通常是通过类路径扫描来⾃动侦测以及⾃动装配到 Spring 容器中（我们可以使⽤ @ComponentScan 注解定义要扫描的路径从中找出标识了需要装配的类⾃动装配到 Spring 的 bean 容器中）。 @Bean 注解通常是我们在标有该注解的⽅法中定义产⽣这个 bean, @Bean 告诉了 Spring 这是某个类的实例，当我需要⽤它的时候还给我。 

@Bean 注解⽐ @Component 注解的⾃定义性更强，⽽且很多地⽅我们只能通过 @Bean 注 解来注册 bean。⽐如当我们引⽤第三⽅库中的类需要装配到 Spring 容器时，则只能通过 @Bean 来实现。

### 注入Bean的注解有哪些

@Autowred、@Resource、@Inject

###  @Autowired 和 @Resource 的区别

@Autowired 属于 Spring 内置的注解，默认的注⼊⽅式为 byType （根据类型进⾏匹配），会优先根据接⼝类型去匹配并注⼊ Bean 。当⼀个接⼝存在多个实现类的话， byType ⽅式⽆法正确注⼊对象,注入方式会变为byName

@Resource 属于 JDK 提供的注解，默认注⼊⽅式为 byName 。如果⽆法通过名称匹配到对应的 Bean 的话，注⼊⽅式会变为 byType 。

@Autowired 是 Spring 提供的注解， @Resource 是 JDK 提供的注解。 

Autowired 默认的注⼊⽅式为 byType （根据类型进⾏匹配）， @Resource 默认注⼊⽅式为 byName （根据名称进⾏匹配）。

 当⼀个接⼝存在多个实现类的情况下， @Autowired 和 @Resource 都需要通过名称才能正确匹 配到对应的 Bean。 Autowired 可以通过 @Qualifier 注解来显示指定名称， @Resource 可以通 过 name 属性来显示指定名称。

### Bean作用域

singleton：IoC容器中只有唯一的bean实例，默认

prototype：每次获取创建一个，得到不同的Bean实例

request：仅web应用可用，每一次http请求产生一个新的bean，仅在request内有效

session：仅web应用可用，每一次来自新的session的http请求产生一个新的bean，仅在该http session有效

application/global-session ：仅web应用可用， 每个 Web 应⽤在启动时创建⼀个 Bean ，该 bean 仅在当前应⽤启动时间内有效。

 websocket ：仅web应用可用，每⼀次 WebSocket 会话产⽣⼀个新的 bean。

可通过xml文件和注解@Scope配置bean的作用域

### 单例 Bean 的线程安全问题

解决方法：

1、在Bean中尽量避免可变的成员变量

2、在类中定义一个ThreadLocal成员变量，将需要的可变成员保存在ThreadLocal中（推荐）

大部分Bean是无状态（没有实例变量的），线程安全

### Bean的生命周期

Bean 容器找到配置⽂件中 Spring Bean 的定义。 

Bean 容器利⽤ Java Reflection API 创建⼀个 Bean 的实例。

 如果涉及到⼀些属性值 利⽤ set() ⽅法设置⼀些属性值。 

如果 Bean 实现了 BeanNameAware 接⼝，调⽤ setBeanName() ⽅法，传⼊ Bean 的名字。 

如果 Bean 实现了 BeanClassLoaderAware 接⼝，调⽤ setBeanClassLoader() ⽅法，传⼊ ClassLoader 对象的实例。 

 如果 Bean 实现了 BeanFactoryAware 接⼝，调⽤ setBeanFactory() ⽅法，传⼊ BeanFactory 对 象的实例。 与上⾯的类似，如果实现了其他 *.Aware 接⼝，就调⽤相应的⽅法。 

如果有和加载这个 Bean 的 Spring 容器相关的 BeanPostProcessor 对象，执 ⾏ postProcessBeforeInitialization() ⽅法 

如果 Bean 实现了 InitializingBean 接⼝，执⾏ afterPropertiesSet() ⽅法。

 如果 Bean 在配置⽂件中的定义包含 init-method 属性，执⾏指定的⽅法。 

如果有和加载这个 Bean 的 Spring 容器相关的 BeanPostProcessor 对象，执 ⾏ postProcessAfterInitialization() ⽅法 

当要销毁 Bean 的时候，如果 Bean 实现了 DisposableBean 接⼝，执⾏ destroy() ⽅法。 

当要销毁 Bean 的时候，如果 Bean 在配置⽂件中的定义包含 destroy-method 属性，执⾏指定 的⽅法。

[**如何记忆Spring Bean的生命周期**](https://chaycao.github.io/2020/02/15/%E5%A6%82%E4%BD%95%E8%AE%B0%E5%BF%86Spring-Bean%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F.html)

![spring-bean-lifestyle](/assets/img/2024-9-16-spring/spring-bean-lifestyle.png)

## AOP

